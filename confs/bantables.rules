# Generated by iptables-save v1.4.7 on Mon Aug 19 18:47:12 2013
*mangle
:PREROUTING ACCEPT [545:42317]
:INPUT ACCEPT [545:42317]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [303:52742]
:POSTROUTING ACCEPT [303:52742]
COMMIT
# Completed on Mon Aug 19 18:47:12 2013
# Generated by iptables-save v1.4.7 on Mon Aug 19 18:47:12 2013
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
:httpscan - [0:0]
-A INPUT -m state --state INVALID -j DROP 
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT 
-A INPUT -p tcp -m multiport --sports 22,80,443 -m state --state NEW -j ACCEPT 
-A INPUT -p udp -m multiport --sports 53,67 -m state --state NEW -j ACCEPT 
-A INPUT -p tcp -m multiport --dports 25,993,995,3128 -m state --state NEW -j ACCEPT 
-A INPUT -p tcp -m tcp --dport 80 -m state --state NEW -m recent --set --name DEFAULT --rsource 
-A INPUT -p tcp -m tcp --dport 80 -m state --state NEW -m recent --update --seconds 3600 --hitcount 2 --rttl --name DEFAULT --rsource -m set --match-set httpscan-3 src -j LOG --log-prefix "HTTP 404 Ban: " 
-A INPUT -p tcp -m tcp --dport 80 -m state --state NEW -m recent --update --seconds 3600 --hitcount 2 --rttl --name DEFAULT --rsource -m set --match-set httpscan-3 src -j TARPIT  --tarpit 
-A INPUT -p tcp -m tcp --dport 80 -m state --state NEW -j ACCEPT 
-A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -m recent --set --name DEFAULT --rsource 
-A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -m recent --update --seconds 3600 --hitcount 3 --rttl --name DEFAULT --rsource -j LOG --log-prefix "SSH IDS BAN: " 
-A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -m recent --rcheck --seconds 3600 --hitcount 3 --name DEFAULT --rsource -j TARPIT  --tarpit 
-A INPUT -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT 
-A OUTPUT -p tcp -m tcp --sport 80 -m string --string "404" --algo bm --from 301 --to 303 -j httpscan 
-A OUTPUT -p tcp -m multiport --sports 22,25,80,993,995 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT 
-A OUTPUT -p tcp -m multiport --dports 22,80,443 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT 
-A OUTPUT -p udp -m multiport --dports 53,67 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT 
-A httpscan -m set --match-set httpscan-2 dst -j SET --add-set httpscan-3 dst 
-A httpscan -m set --match-set httpscan dst -j SET --add-set httpscan-2 dst 
-A httpscan -m set ! --match-set httpscan dst -j SET --add-set httpscan dst 
COMMIT
# Completed on Mon Aug 19 18:47:12 2013
